---
layout: null
---
{% assign posts_by_tag = "" | split: "" %}
{% for post in site.posts %}
  {% for tag in post.tags %}
    {% assign posts_by_tag = posts_by_tag | push: tag | push: post.url %}
  {% endfor %}
{% endfor %}

{
  "nodes": [
    {% for post in site.posts %}
      {
        "id": "{{ post.url }}",
        "label": {{ post.title | jsonify }},
        "group": {{ post.categories | first | jsonify | default: "default" }}
      }
      {% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "links": [
    {% assign processed_pairs = "" | split: "" %}
    {% for tag in site.tags %}
      {% assign tagged_posts = site.posts | where_exp: "post", "post.tags contains tag.first" %}
      {% for i in (0..tagged_posts.size) %}
        {% for j in (i..tagged_posts.size) %}
          {% assign post1 = tagged_posts[i] %}
          {% assign post2 = tagged_posts[j] %}
          {% if post1 and post2 and post1.url != post2.url %}
            {% assign pair1 = post1.url | append: post2.url %}
            {% assign pair2 = post2.url | append: post1.url %}
            {% unless processed_pairs contains pair1 or processed_pairs contains pair2 %}
              {
                "from": "{{ post1.url }}",
                "to": "{{ post2.url }}"
              }
              {% assign processed_pairs = processed_pairs | push: pair1 %}
              ,
            {% endunless %}
          {% endif %}
        {% endfor %}
      {% endfor %}
    {% endfor %}
    {}
  ]
}
